<div class="flex h-screen overflow-visible">
  <app-sidenav-ws class="relative z-20"></app-sidenav-ws>

  <!-- Main content -->
  <div class="flex-1 flex flex-col overflow-visible">
    <app-header-ws class="relative z-0"></app-header-ws>

    <!-- Page Content -->
    <main class="flex-1 overflow-y-auto p-6">
      <div class="p-6 bg-white border border-sky-200 rounded-lg shadow-lg">
        <h2 class="text-xl font-semibold text-sky-600 mb-4 text-center">
          Comparación Visual entre Segmentación Automática y Manual
        </h2>

        <div *ngIf="loading" class="text-center text-sky-500">
          <div class="flex justify-center items-center space-x-2">
            <svg
              class="animate-spin h-6 w-6 text-sky-500"
              fill="none"
              viewBox="0 0 24 24"
            >
              <circle
                class="opacity-25"
                cx="12"
                cy="12"
                r="10"
                stroke="currentColor"
                stroke-width="4"
              ></circle>
              <path
                class="opacity-75"
                fill="currentColor"
                d="M4 12a8 8 0 018-8v4l3-3-3-3v4a8 8 0 100 16v-4l-3 3 3 3v-4a8 8 0 01-8-8z"
              ></path>
            </svg>
            <span>Cargando visualización...</span>
          </div>
        </div>

        <div *ngIf="error" class="text-red-500 text-center">{{ error }}</div>

        <div *ngIf="comparisonUrl && !loading" class="flex gap-6">
          <!-- Visualización (izquierda) -->
           <div>
  <label>Modalidad:</label>
  <select [(ngModel)]="modality" (change)="loadComparison()">
    <option value="flair">FLAIR</option>
    <option value="t1c">T1c</option>
  </select>

  <label>Orientación:</label>
  <select [(ngModel)]="orientation" (change)="loadComparison()">
    <option value="axial">Axial</option>
    <option value="coronal">Coronal</option>
    <option value="sagittal">Sagital</option>
  </select>
</div>

          <div class="w-3/4">
            <iframe
              [src]="comparisonUrl"
              width="100%"
              height="650"
              class="border rounded-lg shadow"
            ></iframe>
          </div>

          <!-- Formulario (derecha) -->
          <div
            class="w-1/4 border border-sky-200 rounded-lg p-4 shadow bg-gray-50"
          >
            <h3 class="text-lg font-semibold text-gray-700 mb-4 text-center">
              Diagnóstico presuntivo
            </h3>

            <form (ngSubmit)="submitDiagnosis()" class="space-y-4">
              <div>
                <label class="block mb-1 text-sm text-gray-700"
                  >¿Es adecuada la segmentación?</label
                >
                <select
                  [(ngModel)]="diagnosticOk"
                  name="diagnosticOk"
                  class="w-full border rounded p-2"
                  required
                >
                  <option value="" disabled selected>Seleccione</option>
                  <option value="Sí">Sí</option>
                  <option value="Neutro">Neutro</option>
                  <option value="No">No</option>
                </select>
              </div>

              <div>
                <label class="block mb-1 text-sm text-gray-700"
                  >Observaciones</label
                >
                <textarea
                  [(ngModel)]="observations"
                  name="observations"
                  class="w-full border rounded p-2 h-28"
                  required
                ></textarea>
              </div>

              <button
                type="submit"
                class="bg-sky-600 text-white w-full py-2 rounded hover:bg-sky-700 transition"
              >
                Enviar
              </button>
            </form>
          </div>
        </div>
      </div>
    </main>
  </div>
</div>
